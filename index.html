<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Free Transactional Email Services Comparison</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      }
      @keyframes gradient {
          0% {
              background-position: 0% 50%;
          }
          50% {
              background-position: 100% 50%;
          }
          100% {
              background-position: 0% 50%;
          }
      }
    .container {
      max-width: 1200px; margin: 0 auto; background: #fff;
      border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden;
    }
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff; padding: 40px 30px; text-align: center;
    }
    h1 { font-size: 2rem; margin-bottom: 10px; }
    .subtitle { opacity: 0.95; font-size: 1rem; }
    .last-update {
      background: #f8f9fa; padding: 15px 30px; border-bottom: 1px solid #e9ecef;
      font-size: 0.9rem; color: #6c757d;
    }
    .table-container { overflow-x: auto; padding: 30px; }
    table { width: 100%; border-collapse: collapse; }
    th, td {
      padding: 12px; text-align: left; border-bottom: 1px solid #e9ecef; font-size: 0.9rem;
    }
    th {
      background: #f8f9fa; font-weight: 600; color: #495057; position: sticky; top: 0;
      text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px;
    }
    tr:hover { background: #f8f9fa; }
    td:nth-child(2), td:nth-child(3) { font-weight: 600; color: #667eea; }
    .service-name { font-weight: 600; color: #212529; }
    .service-link { color: #667eea; text-decoration: none; font-size: 0.85rem; margin-left: 5px; }
    .service-link:hover { text-decoration: underline; }
    .note { font-size: 0.8rem; color: #6c757d; font-style: italic; line-height: 1.3; }
    .status-badge {
      display: inline-block; padding: 2px 8px; border-radius: 12px;
      font-size: 0.75rem; font-weight: 600;
    }
    .status-scraped { background: #d4edda; color: #155724; }
    .status-fallback { background: #fff3cd; color: #856404; }
    .date-cell { font-size: 0.85rem; color: #6c757d; }
    .loading { text-align: center; padding: 60px 30px; color: #6c757d; }
    footer {
      background: #f8f9fa; padding: 20px 30px; text-align: center;
      font-size: 0.85rem; color: #6c757d; border-top: 1px solid #e9ecef;
    }
    @media (max-width: 768px) {
      h1 { font-size: 1.5rem; }
      th, td { padding: 8px 6px; font-size: 0.8rem; }
      .table-container { padding: 15px; }
      #pricesTable th:nth-child(4),
      #pricesTable td:nth-child(4) { display: none; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ðŸ“§ Free Transactional Email Services</h1>
        <p class="subtitle">Compare free tier limits across <span id="providerCount">â€¦</span> providers â€¢ Updated daily â€¢ No affiliate links</p>
    </header>

    <div class="last-update">
      Last check: <strong><span id="lastUpdate">Loading...</span></strong>
    </div>

    <div class="table-container">
      <div id="loading" class="loading">Loading pricing data...</div>

      <table id="pricesTable" style="display:none;">
        <thead>
          <tr>
            <th>Service</th>
            <th>Emails/Day</th>
            <th>Emails/Month</th>
            <th>Notes</th>
            <th>Status</th>
            <th>Last Updated</th>
            <th>Last Change</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

   <footer>
    <p><strong>Legend:</strong> <span class="status-badge status-scraped">Live</span> = Automatically scraped â€¢ <span class="status-badge status-fallback">Static</span> = Using fallback data</p>
    <p style="margin-top:10px;">Data auto-updated daily via GitHub Actions â€¢ Always verify on provider sites</p>
  </footer>
</div>

<!-- IMPORTANT: Load notes.js first -->
<script src="notes.js"></script>

<script>
  // Safe fallback if notes.js fails to load
  window.providerNotes = window.providerNotes || {};

  function formatDate(isoString) {
    if (!isoString) return 'Never';
    const d = new Date(isoString);
    return d.toLocaleDateString('en-US', { year:'numeric', month:'short', day:'numeric' });
  }

  function formatDateTime(isoString) {
    const d = new Date(isoString);
    return d.toLocaleDateString('en-US', { year:'numeric', month:'short', day:'numeric', hour:'2-digit', minute:'2-digit' });
  }

  fetch('data.json')
    .then(r => r.json())
    .then(data => {
      const tbody = document.querySelector('#pricesTable tbody');
      const lastUpdate = data[0]?.lastScraped || new Date().toISOString();
      document.getElementById('lastUpdate').textContent = formatDateTime(lastUpdate);
      document.getElementById('providerCount').textContent = data.length;

      data.forEach(service => {
        const row = tbody.insertRow();

        const nameCell = row.insertCell(0);
        nameCell.innerHTML = `
          <span class="service-name">${service.name}</span>
          <a href="${service.url}" target="_blank" class="service-link" title="Visit pricing page">â†—</a>
        `;

        row.insertCell(1).textContent = service.dailyLimit ? service.dailyLimit.toLocaleString() : 'N/A';
        row.insertCell(2).textContent = service.monthlyLimit ? service.monthlyLimit.toLocaleString() : 'N/A';

        const noteCell = row.insertCell(3);
        const note = window.providerNotes[service.name] || '';
        noteCell.innerHTML = note ? `<span class="note">${note}</span>` : '';

        const statusCell = row.insertCell(4);
        const statusClass = service.scrapedSuccessfully ? 'status-scraped' : 'status-fallback';
        const statusText = service.scrapedSuccessfully ? 'Live' : 'Static';
        statusCell.innerHTML = `<span class="status-badge ${statusClass}">${statusText}</span>`;

        const upd = row.insertCell(5);
        upd.className = 'date-cell';
        upd.textContent = formatDate(service.lastScraped);

        const chg = row.insertCell(6);
        chg.className = 'date-cell';
        chg.textContent = formatDate(service.lastChanged);
      });

      document.getElementById('loading').style.display = 'none';
      document.getElementById('pricesTable').style.display = 'table';
    })
    .catch(err => {
      document.getElementById('loading').innerHTML =
        '<p style="color:red;">Error loading data. Please try again later.</p>';
      console.error('Error fetching data:', err);
    });
</script>
</body>
</html>

